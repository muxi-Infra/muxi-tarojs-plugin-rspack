# tarojs-plugin-rspack

ä¸“é—¨ä¼˜åŒ–å¾®ä¿¡å°ç¨‹åºæ„å»ºçš„ Taro.js æ’ä»¶ï¼Œä½¿ç”¨ Rspack æŠ€æœ¯æä¾›æé€Ÿçš„å°ç¨‹åºæ„å»ºä½“éªŒã€‚

## ç‰¹æ€§

- âš¡ **æé€Ÿæ„å»º**: ä½¿ç”¨ Rspack ä¼˜åŒ–å°ç¨‹åºæ„å»ºï¼Œæ„å»ºé€Ÿåº¦æå‡ 5-10 å€
- ğŸ“± **ä¸“æ³¨å°ç¨‹åº**: é’ˆå¯¹å¾®ä¿¡å°ç¨‹åºå¹³å°æ·±åº¦ä¼˜åŒ–
- ğŸ”§ **é›¶é…ç½®**: å¼€ç®±å³ç”¨ï¼Œè‡ªåŠ¨åº”ç”¨æœ€ä½³å®è·µ
- ğŸ“¦ **æ™ºèƒ½åˆ†åŒ…**: ä¼˜åŒ–çš„ä»£ç åˆ†å‰²ç­–ç•¥ï¼Œå‡å°‘å°ç¨‹åºåŒ…ä½“ç§¯
- ğŸ› ï¸ **SWC ç¼–è¯‘**: ä½¿ç”¨ SWC æ›¿ä»£ Babelï¼Œæ˜¾è‘—æå‡ç¼–è¯‘é€Ÿåº¦
- ğŸ¯ **Tree Shaking**: å†…ç½® Tree Shaking ä¼˜åŒ–ï¼Œç§»é™¤æœªä½¿ç”¨ä»£ç 

## å®‰è£…

```bash
# npm
npm install tarojs-plugin-rspack --save-dev

# yarn
yarn add tarojs-plugin-rspack --dev

# pnpm
pnpm add tarojs-plugin-rspack -D
```

## ä½¿ç”¨æ–¹æ³•

### åŸºç¡€ç”¨æ³•

åœ¨ä½ çš„ Taro å°ç¨‹åºé¡¹ç›®é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ `config/index.js`ï¼‰ä¸­æ·»åŠ æ’ä»¶ï¼š

```javascript
const config = {
  projectName: 'myWeappApp',
  framework: 'react',
  compiler: 'webpack', // ä¿æŒ webpackï¼Œæ’ä»¶ä¼šè‡ªåŠ¨åº”ç”¨ Rspack ä¼˜åŒ–
  plugins: [
    ['tarojs-plugin-rspack'] // é›¶é…ç½®ï¼Œå¼€ç®±å³ç”¨
  ]
}

module.exports = function (merge) {
  if (process.env.NODE_ENV === 'development') {
    return merge({}, config, require('./dev'))
  }
  return merge({}, config, require('./prod'))
}
```

### é«˜çº§é…ç½®

```javascript
const config = {
  // å…¶ä»–é…ç½®...
  plugins: [
    ['tarojs-plugin-rspack', {
      // æ˜¯å¦å¯ç”¨æ„å»ºåˆ†æ
      analyze: false,
      
      // æ˜¯å¦å¯ç”¨å‹ç¼©ä¼˜åŒ–
      compress: true,
      
      // è‡ªå®šä¹‰ä¼˜åŒ–é€‰é¡¹
      optimization: {
        // æ˜¯å¦å¯ç”¨ä»£ç åˆ†å‰²ä¼˜åŒ–
        splitChunks: true,
        
        // æ˜¯å¦å¯ç”¨ Tree Shaking
        treeShaking: true,
        
        // æ˜¯å¦å¯ç”¨ SWC ç¼–è¯‘ä¼˜åŒ–
        useSwc: true
      }
    }]
  ]
}
```

## é…ç½®é€‰é¡¹

### analyze

æ˜¯å¦å¯ç”¨æ„å»ºåˆ†æï¼Œç”Ÿæˆæ„å»ºæŠ¥å‘Šï¼š

```javascript
{
  analyze: true // å¼€å¯åä¼šç”Ÿæˆæ„å»ºåˆ†ææŠ¥å‘Š
}
```

### compress

æ˜¯å¦å¯ç”¨å‹ç¼©ä¼˜åŒ–ï¼š

```javascript
{
  compress: true // åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å‹ç¼©ä»£ç 
}
```

### optimization

è¯¦ç»†çš„ä¼˜åŒ–é€‰é¡¹ï¼š

```javascript
{
  optimization: {
    splitChunks: true,  // å¯ç”¨ä»£ç åˆ†å‰²
    treeShaking: true,  // å¯ç”¨ Tree Shaking
    useSwc: true        // ä½¿ç”¨ SWC ç¼–è¯‘å™¨
  }
}
```

## æ”¯æŒçš„æ–‡ä»¶ç±»å‹

- **JavaScript/TypeScript**: `.js`, `.jsx`, `.ts`, `.tsx`
- **æ ·å¼æ–‡ä»¶**: `.css`, `.scss`, `.sass`
- **èµ„æºæ–‡ä»¶**: `.png`, `.jpg`, `.jpeg`, `.gif`, `.svg`, `.webp`
- **å­—ä½“æ–‡ä»¶**: `.woff`, `.woff2`, `.eot`, `.ttf`, `.otf`

## å†…ç½®ä¼˜åŒ–

### Loader ä¼˜åŒ–

- ä½¿ç”¨ `builtin:swc-loader` æ›¿ä»£ `babel-loader` å’Œ `ts-loader`
- ä½¿ç”¨ `builtin:lightningcss-loader` å¤„ç† CSS
- å†…ç½® Sass æ”¯æŒ

### æ’ä»¶ä¼˜åŒ–

- è‡ªåŠ¨è½¬æ¢ `HtmlWebpackPlugin` ä¸º `HtmlRspackPlugin`
- ä¼˜åŒ–çš„ä»£ç åˆ†å‰²ç­–ç•¥
- å†…ç½®ç¯å¢ƒå˜é‡æ³¨å…¥

## æ€§èƒ½å¯¹æ¯”

| æ„å»ºåœºæ™¯ | Webpack | Rspackä¼˜åŒ– | æ€§èƒ½æå‡ |
|---------|---------|------------|----------|
| å°ç¨‹åºå†·å¯åŠ¨ | ~45s | ~8s | 5.6å€ |
| å¢é‡æ„å»º | ~15s | ~3s | 5å€ |
| ç”Ÿäº§æ„å»º | ~90s | ~18s | 5å€ |
| ä»£ç ç¼–è¯‘ | ~25s | ~4s | 6.3å€ |

*ä»¥ä¸Šæ•°æ®åŸºäºä¸­ç­‰è§„æ¨¡çš„ Taro å°ç¨‹åºé¡¹ç›®æµ‹è¯•*

## å°ç¨‹åºæ„å»ºä¼˜åŒ–

### åŒ…ä½“ç§¯ä¼˜åŒ–
- æ™ºèƒ½ä»£ç åˆ†å‰²ï¼Œå‡å°‘ä¸»åŒ…å¤§å°
- è‡ªåŠ¨æå–å…¬å…±æ¨¡å—åˆ° vendors
- Tree Shaking ç§»é™¤æœªä½¿ç”¨ä»£ç 

### ç¼–è¯‘ä¼˜åŒ–  
- SWC æ›¿ä»£ Babelï¼Œç¼–è¯‘é€Ÿåº¦æå‡ 6 å€
- ä¼˜åŒ–çš„ TypeScript ç¼–è¯‘
- å†…ç½® ES5 å…¼å®¹å¤„ç†

### åˆ†åŒ…ç­–ç•¥
- è‡ªåŠ¨ä¼˜åŒ–åˆ†åŒ…é…ç½®
- æ™ºèƒ½ä¾èµ–åˆ†æ
- è¿è¡Œæ—¶ä»£ç ç‹¬ç«‹æ‰“åŒ…

## æ³¨æ„äº‹é¡¹

1. **ä¸“æ³¨å°ç¨‹åº**: è¯¥æ’ä»¶ä¸“é—¨é’ˆå¯¹å¾®ä¿¡å°ç¨‹åºå¹³å°ä¼˜åŒ–
2. **å…¼å®¹æ€§**: éœ€è¦ Taro 4.0+ ç‰ˆæœ¬æ”¯æŒ
3. **å¼€å‘å·¥å…·**: éœ€è¦å¾®ä¿¡å¼€å‘è€…å·¥å…·è¿›è¡Œé¢„è§ˆå’Œè°ƒè¯•
4. **Node.js ç‰ˆæœ¬**: éœ€è¦ Node.js 16+ ç‰ˆæœ¬

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. å°ç¨‹åºé¢„è§ˆå¤±è´¥

**é—®é¢˜**: æ„å»ºå®Œæˆä½†å°ç¨‹åºå¼€å‘è€…å·¥å…·æ— æ³•é¢„è§ˆ

**è§£å†³æ–¹æ³•**: 
- æ£€æŸ¥å°ç¨‹åº AppID é…ç½®
- ç¡®è®¤ `project.config.json` é…ç½®æ­£ç¡®
- éªŒè¯å°ç¨‹åºåŸºç¡€åº“ç‰ˆæœ¬å…¼å®¹æ€§

#### 2. åŒ…ä½“ç§¯è¿‡å¤§

**é—®é¢˜**: ä¸»åŒ…è¶…è¿‡ 2MB é™åˆ¶

**è§£å†³æ–¹æ³•**: 
- å¯ç”¨ `optimization.splitChunks`
- é…ç½®åˆ†åŒ…ç­–ç•¥
- æ£€æŸ¥æœªä½¿ç”¨çš„ä¾èµ–

#### 3. ç¼–è¯‘é”™è¯¯

**é—®é¢˜**: SWC ç¼–è¯‘æŠ¥é”™

**è§£å†³æ–¹æ³•**: 
```bash
# ç¡®ä¿å®‰è£…äº†å¿…è¦ä¾èµ–
pnpm add sass -D

# æ£€æŸ¥ TypeScript é…ç½®
```

#### 4. æ ·å¼æ–‡ä»¶å¤„ç†å¼‚å¸¸

**è§£å†³æ–¹æ³•**: æ£€æŸ¥ PostCSS å’Œ Sass é…ç½®ï¼š

```javascript
// åœ¨ mini é…ç½®ä¸­æ·»åŠ 
postcss: {
  pxtransform: {
    enable: true
  }
}
```

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è®¸å¯è¯

MIT

## æ›´æ–°æ—¥å¿—

### v1.0.0

- ğŸ‰ é¦–æ¬¡å‘å¸ƒ
- âš¡ ä¸“æ³¨å¾®ä¿¡å°ç¨‹åºæ„å»ºä¼˜åŒ–
- ğŸ› ï¸ é›†æˆ SWC ç¼–è¯‘å™¨ï¼Œæ˜¾è‘—æå‡ç¼–è¯‘é€Ÿåº¦
- ğŸ“¦ æ™ºèƒ½ä»£ç åˆ†å‰²å’ŒåŒ…ä½“ç§¯ä¼˜åŒ–
- ğŸ¯ å†…ç½® Tree Shaking å’Œ ES5 å…¼å®¹å¤„ç†
- ğŸ”§ é›¶é…ç½®å¼€ç®±å³ç”¨ 